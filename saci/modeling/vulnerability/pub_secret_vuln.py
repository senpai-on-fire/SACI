from .base_vuln import BaseVulnerability


class PublicSecretVulnerability(BaseVulnerability):
    """
    A PublicSecretVulnerability is a vulnerability that occurs when a component leaks information of something
    that should normally be secret. This is easy to understand in the context of Telemetry:
    Given we have Drone (D), good user (A) and bad user (B) with the following scenario:

    A -> (Token) -> D

    --- MITM, Unencrypted data ---

    B -> (Token) -> D

    D believes that both A and B are the same user, which is a vulnerability. This is a public secret vulnerability.
    """
    def __init__(self, component, _input, output, attack_ASP=None, rulefile=None):
        super().__init__(component, _input, output, attack_ASP=attack_ASP, rulefile=rulefile)
